<div [formGroup]="profileForm" class="p-4 flex flex-col items-center gap-4 w-full">
    <div class="profile-image-container">
        @if(user.image){
            <img
                [src]="user.image"
                alt="Profile Picture"
                class="profile-image"
            />
        } @else {
            <img src="https://primefaces.org/cdn/primeng/images/demo/avatar/amyelsner.png" alt="Profile Picture" class="profile-image" />
        }

        <div class="edit-overlay" (click)="triggerFileInput()">
            <i class="pi pi-pencil edit-icon" pTooltip="Nueva Foto" tooltipPosition="bottom"></i>
        </div>

        <input type="file" #fileInput accept="image/*" (change)="onFileSelected($event)" hidden />
    </div>

    <div class="flex flex-col gap-4 w-full mt-4">
        <div class="flex gap-4 w-full items-center">
            <div class="w-full">
                <p-floatlabel>
                    <input id="name" pInputText formControlName="name" class="w-full" />
                    <label for="name">Nombre:</label>
                </p-floatlabel>
            </div>
            <div class="w-full">
                <p-floatlabel>
                    <input id="last_name" pInputText formControlName="last_name" class="w-full" />
                    <label for="last_name">Apellido:</label>
                </p-floatlabel>
            </div>
            <div>
                <p-button icon="fas fa-save" [rounded]="true" severity="info" pTooltip="Guardar" pTooltipPosition="bottom" (click)="saveProfile()"></p-button>
            </div>
        </div>

        <div class="flex gap-4 w-full mt-2">
            <div class="w-full">
                <p-floatlabel>
                    <input id="email" pInputText formControlName="email" class="w-full" />
                    <label for="email">Email:</label>
                </p-floatlabel>
            </div>
            <div class="w-full">
                <p-floatlabel>
                    <input id="username" pInputText formControlName="username" class="w-full" />
                    <label for="username">Usuario:</label>
                </p-floatlabel>
            </div>
            <div class="w-full">
                <p-floatlabel>
                     <p-select formControlName="gender" placeholder="Seleccione el genero" [options]="genders" class="w-full"></p-select>
                    <label for="gender">Genero:</label>
                </p-floatlabel>
            </div>
        </div>

        <div class="flex gap-4 w-full mt-2">
            <div class="w-full">
                <p-floatlabel>
                    <input id="zone" pInputText formControlName="zone" class="w-full" />
                    <label for="zone">Zona:</label>
                </p-floatlabel>
            </div>
            <div class="w-full">
                <p-floatlabel>
                    <input id="role" pInputText formControlName="role" class="w-full" />
                    <label for="role">Rol:</label>
                </p-floatlabel>
            </div>
            <div class="w-full">
                <p-floatlabel>
                    <p-datepicker formControlName="birthDate" appendTo="body" showButtonBar="true" styleClass="w-full"></p-datepicker>
                    <label for="birthDate">Fecha de Nacimiento:</label>
                </p-floatlabel>
            </div>
        </div>
    </div>
</div>

<p-toast></p-toast>
<p-confirmDialog #cd>
    <ng-template let-message let-onAccept="onAccept" let-onReject="onReject">
        <div class="flex flex-col items-center p-8 bg-surface-0 dark:bg-surface-900 rounded">
            <div class="rounded-full bg-primary text-primary-contrast inline-flex justify-center items-center h-24 w-24 -mt-20">
                <i class="pi pi-question !text-5xl"></i>
            </div>
            <span class="font-bold text-2xl block mb-2 mt-6">{{ message.header }}</span>
            <p class="mb-0">{{ message.message }}</p>
            <div class="flex items-center gap-2 mt-6">
                <p-button label="Aceptar" (onClick)="onAccept()" styleClass="w-32"></p-button>
            </div>
        </div>
    </ng-template>
</p-confirmDialog>
